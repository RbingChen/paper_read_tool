<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>OneRecæŠ€æœ¯æŠ¥å‘Šè§£æ</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<style>
  .original { background-color: #f0f0f0; border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; }
  .translation { background-color: #e0f7e0; border: 1px solid #4CAF50; padding: 10px; margin-bottom: 20px; }
  .figure { background-color: #fffde7; padding: 15px; margin: 20px 0; text-align: center; }
  .term { color: red; font-weight: bold; }
  .formula { text-align: center; margin: 20px 0; }
  section { margin-bottom: 30px; }
  h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
</style>
</head>
<body>

<section>
  <h2>1. å†…å®¹ç†è§£ä¸è§£é‡Š</h2>
  <p>è¯¥æŠ€æœ¯æŠ¥å‘Šä¸»è¦æè¿°OneRecæ¨èç³»ç»Ÿä¸­çš„ä¸¤å¤§æ ¸å¿ƒæŠ€æœ¯ï¼š</p>
  <ol>
    <li><span class="term">ECPOï¼ˆEarly-Clipped Policy Optimizationï¼‰</span>ï¼šæ”¹è¿›çš„å¼ºåŒ–å­¦ä¹ ç­–ç•¥ä¼˜åŒ–ç®—æ³•ï¼Œé€šè¿‡å·®å¼‚åŒ–å¤„ç†æ­£è´Ÿä¼˜åŠ¿å€¼ï¼ˆAdvantageï¼‰è§£å†³è®­ç»ƒç¨³å®šæ€§é—®é¢˜ã€‚å¯¹æ­£ä¼˜åŠ¿ï¼ˆğ´>0ï¼‰æ²¿ç”¨GRPOæ–¹æ³•ï¼Œå¯¹è´Ÿä¼˜åŠ¿ï¼ˆğ´<0ï¼‰é‡‡ç”¨æ—©æˆªæ–­ï¼ˆearly-clippingï¼‰æŠ€æœ¯é™åˆ¶ç­–ç•¥æ¯”ç‡ï¼ˆ\(\\pi_\\theta / \\pi_{\\theta_{old}}\)ï¼‰ï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚</li>
    <li><span class="term">ç”Ÿæˆæ ¼å¼æ­£åˆ™åŒ–ï¼ˆGeneration Format Regularizationï¼‰</span>ï¼šè§£å†³ç”Ÿæˆå¼æ¨èä¸­è¯­ä¹‰IDåºåˆ—çš„åˆæ³•æ€§é—®é¢˜ã€‚å¼•å…¥<span class="term">åˆæ³•æ€§æ¯”ç‡ï¼ˆLegality Ratioï¼‰</span>æŒ‡æ ‡ï¼Œå¹¶åˆ†æ<span class="term">æŒ¤å‹æ•ˆåº”ï¼ˆSqueezing Effectï¼‰</span>å¦‚ä½•å¯¼è‡´éæ³•ç”Ÿæˆâ€”â€”å½“æ¨¡å‹é‡åˆ°è´Ÿä¼˜åŠ¿é¡¹æ—¶ï¼Œæ¦‚ç‡åˆ†å¸ƒä¼šè¿‡åº¦é›†ä¸­åœ¨å½“å‰æœ€ä¼˜è¾“å‡ºğ‘œâˆ—ä¸Šã€‚</li>
  </ol>
  <p>æ ¸å¿ƒåˆ›æ–°ç‚¹ï¼šECPOé€šè¿‡å‚æ•°ğ›¿ï¼ˆå¦‚è®¾ä¸º0.1ï¼‰æ§åˆ¶ç­–ç•¥æ¯”ç‡å®¹å¿åº¦ï¼ŒåŒæ—¶ç§»é™¤KLæ•£åº¦æŸå¤±ï¼Œåˆ©ç”¨ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰æŸå¤±ç»´æŒæ¨¡å‹ç¨³å®šæ€§ã€‚</p>
</section>

<section>
  <h2>2. å†…å®¹ç¿»è¯‘</h2>
  
  <div class="original">
    <p>OneRec Technical Report</p>
    <p>Figure 6|Illustration of ECPO. The ğ‘¥-axis isğœ‹ğœƒ/ğœ‹ğœƒğ‘œğ‘™ğ‘‘and theğ‘¦-axis is the clipped ğœ‹ğœƒ/ğœ‹ğœƒğ‘œğ‘™ğ‘‘. Items with ğ´ >0are processed in the same way as the original GRPO, while items with ğ´ <0are constrained by early-clipping to limit the maximum ratio.</p>
    <p>explosion. Therefore, we preemptively clip policies with large ratios to ensure training stability while still allowing corresponding negative advantages to take effect. The larger the ğ›¿, the larger the tolerable policy ratio, which means the larger the tolerable gradient. This can be determined based on actual needs. In OneRec, we set ğ›¿to 0.1, which indicates that the ratio of policies with negative advantages is allowed to slightly exceed 1+ğœ–. We remove the KL divergence loss because the Reinforcement Learning (RL) and Supervised Fine-Tuning (SFT) are trained together in OneRec, and the SFT loss ensures the model remains stable.</p>
  </div>
  <div class="translation">
    <p>OneRecæŠ€æœ¯æŠ¥å‘Š</p>
    <p>å›¾6 | ECPOç¤ºæ„å›¾ã€‚xè½´è¡¨ç¤º\(\\pi_\\theta / \\pi_{\\theta_{old}}\)ï¼Œyè½´è¡¨ç¤ºæˆªæ–­åçš„\(\\pi_\\theta / \\pi_{\\theta_{old}}\)ã€‚ğ´>0çš„é¡¹ç›®æŒ‰åŸå§‹GRPOæ–¹å¼å¤„ç†ï¼Œè€Œğ´<0çš„é¡¹ç›®é€šè¿‡æ—©æˆªæ–­ï¼ˆearly-clippingï¼‰çº¦æŸä»¥é™åˆ¶æœ€å¤§æ¯”ç‡ã€‚</p>
    <p>å› æ­¤ï¼Œæˆ‘ä»¬ä¸»åŠ¨æˆªæ–­é«˜æ¯”ç‡çš„ç­–ç•¥ä»¥ä¿è¯è®­ç»ƒç¨³å®šæ€§ï¼ŒåŒæ—¶ä»è®©å¯¹åº”çš„è´Ÿä¼˜åŠ¿å€¼å‘æŒ¥ä½œç”¨ã€‚ğ›¿è¶Šå¤§ï¼Œå¯å®¹å¿çš„ç­–ç•¥æ¯”ç‡è¶Šå¤§ï¼Œæ„å‘³ç€å¯å®¹å¿çš„æ¢¯åº¦è¶Šå¤§ã€‚è¿™å¯æ ¹æ®å®é™…éœ€æ±‚ç¡®å®šã€‚åœ¨OneRecä¸­ï¼Œæˆ‘ä»¬è®¾ç½®ğ›¿=0.1ï¼Œè¿™å…è®¸è´Ÿä¼˜åŠ¿ç­–ç•¥çš„æ¯”ç‡ç•¥å¾®è¶…è¿‡1+ğœ–ã€‚æˆ‘ä»¬ç§»é™¤äº†KLæ•£åº¦æŸå¤±ï¼Œå› ä¸ºåœ¨OneRecä¸­å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰å’Œç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰è”åˆè®­ç»ƒï¼ŒSFTæŸå¤±å¯ç¡®ä¿æ¨¡å‹ç¨³å®šæ€§ã€‚</p>
  </div>

  <div class="original">
    <p>2.4.2. Generation Format Regularization</p>
    <p>In generative recommendation, the legality ratio refers to the proportion of generated semantic ID sequences that can be mapped to actual item IDs. This metric is crucial for assessing the stability of generation. In practice, the cardinality of semantic ID sequences ğ‘ğ¿ğ‘¡ ğ‘¡is much larger than that of videos. This ensures that all items are covered, and a larger vocabulary introduces more parameters, leading to better performance. However, this may also result in generating semantic ID sequences without corresponding item IDs during inference, i.e., illegal generation.</p>
  </div>
  <div class="translation">
    <p>2.4.2. ç”Ÿæˆæ ¼å¼æ­£åˆ™åŒ–</p>
    <p>åœ¨ç”Ÿæˆå¼æ¨èä¸­ï¼Œ<span class="term">åˆæ³•æ€§æ¯”ç‡ï¼ˆlegality ratioï¼‰</span>æŒ‡å¯æ˜ å°„åˆ°å®é™…ç‰©å“IDçš„ç”Ÿæˆè¯­ä¹‰IDåºåˆ—çš„æ¯”ä¾‹ã€‚è¯¥æŒ‡æ ‡å¯¹è¯„ä¼°ç”Ÿæˆç¨³å®šæ€§è‡³å…³é‡è¦ã€‚å®è·µä¸­ï¼Œè¯­ä¹‰IDåºåˆ—çš„åŸºæ•°\(N_{L_t}^t\)è¿œå¤§äºè§†é¢‘æ•°é‡ï¼Œè¿™ç¡®ä¿äº†æ‰€æœ‰ç‰©å“çš„è¦†ç›–ï¼Œæ›´å¤§çš„è¯æ±‡è¡¨å¼•å…¥æ›´å¤šå‚æ•°ä»è€Œæå‡æ€§èƒ½ã€‚ä½†ä¹Ÿå¯èƒ½åœ¨æ¨ç†æ—¶ç”Ÿæˆæ— å¯¹åº”ç‰©å“IDçš„è¯­ä¹‰IDåºåˆ—ï¼Œå³éæ³•ç”Ÿæˆã€‚</p>
  </div>

  <div class="original">
    <p>Figure 7|Illustration of squeezing effect. ğœ‹ğœƒğ‘ƒğ‘‡represents the pre-trained model, while ğœ‹ğœƒğ‘…ğ¿represents the model trained with ECPO. ğ‘œ+refers to videos with positive advantages, while ğ‘œâˆ’refers to those with negative advantages.</p>
    <p>Introducing reinforcement learning with ECPO significantly increases the generation of illegal outputs. Recent work (Ren and Sutherland, 2024) suggests that this is due to the squeezing effect caused by negative advantages. As shown in Figure 7, the pre-trained model has learned to generate most of the legal tokens. After incorporating RL, items with ğ´ >0only slightly adjust the distribution. When an item with ğ´ <0is applied, the modelâ€™s probability distribution compresses most of the probability mass into what it currently considers the optimal output ğ‘œâˆ—. This results in the probabilities</p>
  </div>
  <div class="translation">
    <p>å›¾7 | æŒ¤å‹æ•ˆåº”ç¤ºæ„å›¾ã€‚\(\\pi_{\\theta_{PT}}\)è¡¨ç¤ºé¢„è®­ç»ƒæ¨¡å‹ï¼Œ\(\\pi_{\\theta_{RL}}\)è¡¨ç¤ºç»ECPOè®­ç»ƒçš„æ¨¡å‹ã€‚ğ‘œ+æŒ‡å…·æœ‰æ­£ä¼˜åŠ¿çš„è§†é¢‘ï¼Œğ‘œâˆ’æŒ‡å…·æœ‰è´Ÿä¼˜åŠ¿çš„è§†é¢‘ã€‚</p>
    <p>å¼•å…¥åŸºäºECPOçš„å¼ºåŒ–å­¦ä¹ ä¼šæ˜¾è‘—å¢åŠ éæ³•è¾“å‡ºç”Ÿæˆã€‚è¿‘æœŸç ”ç©¶(Ren and Sutherland, 2024)è¡¨æ˜è¿™æ˜¯è´Ÿä¼˜åŠ¿å¼•èµ·çš„<span class="term">æŒ¤å‹æ•ˆåº”ï¼ˆsqueezing effectï¼‰</span>æ‰€è‡´ã€‚å¦‚å›¾7æ‰€ç¤ºï¼Œé¢„è®­ç»ƒæ¨¡å‹å·²å­¦ä¼šç”Ÿæˆå¤§å¤šæ•°åˆæ³•æ ‡è®°ã€‚åŠ å…¥å¼ºåŒ–å­¦ä¹ åï¼Œğ´>0çš„é¡¹ä»…å¾®è°ƒåˆ†å¸ƒï¼›è€Œå½“åº”ç”¨ğ´<0çš„é¡¹æ—¶ï¼Œæ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒå°†å¤§éƒ¨åˆ†æ¦‚ç‡è´¨é‡å‹ç¼©åˆ°å½“å‰è®¤ä¸ºçš„æœ€ä¼˜è¾“å‡ºğ‘œâˆ—ä¸Šï¼Œå¯¼è‡´æ¦‚ç‡åˆ†å¸ƒå¤±è¡¡ã€‚</p>
  </div>
  
  <div class="figure">
    <p>å›¾ç¤ºè¯´æ˜ï¼ˆFigure 6 & 7ï¼‰</p>
    <p>Figure 6: å±•ç¤ºECPOæœºåˆ¶â€”â€”æ­£è´Ÿä¼˜åŠ¿å€¼çš„å·®å¼‚åŒ–å¤„ç†</p>
    <p>Figure 7: å±•ç¤ºæŒ¤å‹æ•ˆåº”â€”â€”è´Ÿä¼˜åŠ¿å€¼å¯¼è‡´æ¦‚ç‡åˆ†å¸ƒåç¼©</p>
  </div>
</section>

<section>
  <h2>3. æ‘˜è¦æ€»ç»“</h2>
  <p>æœ¬æŠ¥å‘Šæ ¸å¿ƒå†…å®¹èšç„¦äºOneRecæ¨èç³»ç»Ÿçš„ä¸¤å¤§æŠ€æœ¯åˆ›æ–°ï¼š</p>
  <ul>
    <li><span class="term">ECPOç®—æ³•</span>ï¼šé€šè¿‡æ—©æˆªæ–­æœºåˆ¶ï¼ˆearly-clippingï¼‰å¤„ç†è´Ÿä¼˜åŠ¿å€¼ï¼ˆğ´<0ï¼‰ï¼Œç­–ç•¥æ¯”ç‡é™åˆ¶ä¸º\(1+\\epsilon+\\delta\)ï¼ˆğ›¿=0.1ï¼‰ï¼Œåœ¨ä¿è¯è®­ç»ƒç¨³å®šæ€§çš„åŒæ—¶ç§»é™¤KLæ•£åº¦æŸå¤±ï¼Œå®ç°RLä¸SFTçš„è”åˆä¼˜åŒ–ã€‚</li>
    <li><span class="term">ç”Ÿæˆåˆæ³•æ€§ä¿éšœ</span>ï¼šå®šä¹‰<span class="term">åˆæ³•æ€§æ¯”ç‡</span>è¯„ä¼°è¯­ä¹‰IDåºåˆ—çš„æœ‰æ•ˆæ€§ï¼Œæ­ç¤º<span class="term">æŒ¤å‹æ•ˆåº”</span>æ˜¯éæ³•ç”Ÿæˆçš„ä¸»å› â€”â€”è´Ÿä¼˜åŠ¿å€¼ä½¿æ¦‚ç‡åˆ†å¸ƒè¿‡åº¦é›†ä¸­äºå±€éƒ¨æœ€ä¼˜è§£ğ‘œâˆ—ã€‚</li>
  </ul>
  <p>å…³é”®æŠ€æœ¯æ•ˆæœï¼šECPOè§£å†³ç­–ç•¥ä¼˜åŒ–ä¸­çš„æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼Œè€Œç”Ÿæˆæ­£åˆ™åŒ–æœºåˆ¶æå‡æ¨èç»“æœçš„å¯ç”¨æ€§ã€‚</p>
</section>

<section>
  <h2>4. å…³é”®æœ¯è¯­è§£é‡Š</h2>
  <dl>
    <dt><span class="term">ECPO (Early-Clipped Policy Optimization)</span></dt>
    <dd>æ”¹è¿›çš„ç­–ç•¥ä¼˜åŒ–ç®—æ³•ï¼Œå¯¹æ­£ä¼˜åŠ¿å€¼ï¼ˆğ´>0ï¼‰æ²¿ç”¨æ ‡å‡†æ–¹æ³•ï¼Œå¯¹è´Ÿä¼˜åŠ¿å€¼ï¼ˆğ´<0ï¼‰é‡‡ç”¨æ—©æˆªæ–­æŠ€æœ¯é™åˆ¶ç­–ç•¥æ¯”ç‡\(\\pi_\\theta / \\pi_{\\theta_{old}}\)ï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚</dd>
    
    <dt><span class="term">ç­–ç•¥æ¯”ç‡ï¼ˆPolicy Ratioï¼‰\(\\pi_\\theta / \\pi_{\\theta_{old}}\)</span></dt>
    <dd>æ–°ç­–ç•¥ä¸æ—§ç­–ç•¥çš„æ¦‚ç‡æ¯”ï¼ŒECPOä¸­é€šè¿‡å‚æ•°ğœ–å’Œğ›¿æ§åˆ¶å…¶å˜åŒ–èŒƒå›´ï¼ˆå¦‚è´Ÿä¼˜åŠ¿æ—¶ä¸Šé™ä¸º\(1+\\epsilon+\\delta\)ï¼‰ã€‚</dd>
    
    <dt><span class="term">æŒ¤å‹æ•ˆåº”ï¼ˆSqueezing Effectï¼‰</span></dt>
    <dd>è´Ÿä¼˜åŠ¿å€¼å¯¼è‡´çš„æ¦‚ç‡åˆ†å¸ƒåç¼©ç°è±¡ï¼Œä½¿æ¨¡å‹å°†å¤§éƒ¨åˆ†æ¦‚ç‡è´¨é‡é›†ä¸­äºå½“å‰æœ€ä¼˜è¾“å‡ºğ‘œâˆ—ï¼Œé™ä½ç”Ÿæˆå¤šæ ·æ€§å¹¶äº§ç”Ÿéæ³•è¾“å‡ºã€‚</dd>
    
    <dt><span class="term">åˆæ³•æ€§æ¯”ç‡ï¼ˆLegality Ratioï¼‰</span></dt>
    <dd>ç”Ÿæˆå¼æ¨èçš„å…³é”®æŒ‡æ ‡ï¼Œè¡¡é‡è¯­ä¹‰IDåºåˆ—å¯æ˜ å°„åˆ°çœŸå®ç‰©å“IDçš„æ¯”ä¾‹ï¼Œåæ˜ ç³»ç»Ÿç¨³å®šæ€§ã€‚</dd>
    
    <dt><span class="term">è¯­ä¹‰IDåºåˆ—ï¼ˆSemantic ID Sequenceï¼‰</span></dt>
    <dd>ç”Ÿæˆå¼æ¨èä¸­ä½¿ç”¨çš„ç»“æ„åŒ–æ ‡è¯†ç¬¦ï¼ŒåŸºæ•°\(N_{L_t}^t\)å¤§äºå®é™…ç‰©å“æ•°ä»¥æå‡è¡¨è¾¾èƒ½åŠ›ï¼Œä½†å¯èƒ½äº§ç”Ÿæ— æ•ˆIDã€‚</dd>
  </dl>
</section>

</body>
</html>